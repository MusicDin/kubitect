---
- name: Initialize cluster directory and verify cluster config
  hosts: localhost
  gather_facts: false
  any_errors_fatal: true
  roles:
    - role: config/cluster/import
      tags:
        - init
        - kubespray

    - role: config/infra/import
      tags:
        - kubespray

    - role: generate/inventory/hosts
      tags:
        - init

    - role: generate/inventory/nodes
      tags:
        - gen_nodes

    - role: kubespray
      tags:
        - kubespray

    - role: generate/main-tf
      tags:
        - init
    
    - role: generate/ssh-keys
      tags:
        - init
